(function(a){a.fn.extend({fidget:function(b){function j(){startFingers=null;currentFingers=null;swipeEventStatus="";pinchEventStatus="";shouldHaveMomentum=false;d={startFingers:null,currentFingers:null,duration:0,startPosition:null,swipe:{status:"",distance:{x:0,y:0},direction:"",shouldHaveMomentum:false},pinch:{status:"",startDistance:0,distance:0,direction:"unknown",angle:0},tap:{status:"",target:null},doubleTap:{status:"",target:null}}}function k(a){a.removeEventListener();a.removeEventListener();a.removeEventListener();a.removeEventListener()}if(!this)return false;var c={swipe:null,dragThis:false,pinch:null,zoomThis:false,threshold:20,tap:null,doubleTap:null};b=a.extend(c,b);var d;j();var e,f,g,h,i;return this.each(function(){function j(a){a.preventDefault();d.startFingers=jQuery.extend(true,{},a.touches);d.swipe.status="start";n();if(a.touches.length>1){d.pinch.status="start";d.pinch.startDistance=s();d.pinch.distance=s();o()}d.tap.status="down";d.tap.target=a.changedTouches[0].target;p();e=(new Date).getTime()}function k(a){a.preventDefault();d.swipe.status="move";d.swipe.distance=q();if(a.touches.length>1){d.pinch.status="move";d.pinch.distance=s();if(d.pinch.distance>d.pinch.startDistance)d.pinch.direction="out";if(d.pinch.distance<d.pinch.startDistance)d.pinch.direction="in";d.pinch.angle=t();o()}d.duration=r();n()}function l(a){a.preventDefault();d.swipe.status="end";if(d.pinch.status=="start"||d.pinch.status=="move"){d.pinch.status="end";o()}if(d.duration-(new Date).getTime()<300){d.swipe.shouldHaveMomentum=true}n();if(d.tap.target==a.changedTouches[0].target){d.tap.status="up"}else{d.tap.status="cancel"}p()}function m(a){a.preventDefault();d.swipe.status="cancel";d.pinch.status="cancel";n();o()}function n(){d.swipe.direction="up";if(d.swipe.status=="start"){d.startPosition={x:parseInt(b.css("left"),10),y:parseInt(b.css("top"),10)}}if(c.dragThis&&d.swipe.status=="move"){f=event.touches[0].pageX-d.startFingers[0].pageX;g=event.touches[0].pageY-d.startFingers[0].pageY;h=d.startPosition.y+g+"px";i=d.startPosition.x+f+"px";b.css("top",h);b.css("left",i)}if(c.swipe)c.swipe.call(b,event,d)}function o(){if(c.pinch){if(c.zoomThis){var a=s()/d.pinch.startDistance;b.css("webkitTransform","scale("+a+")")}c.pinch.call(b,event,d)}}function p(){if(c.tap)c.tap.call(b,event,d)}function q(){return{x:event.touches[0].pageX-d.startFingers[0].pageX,y:event.touches[0].pageY-d.startFingers[0].pageY}}function r(){return(new Date).getTime()-e}function s(){if(event.touches.length>1){var a=event.touches[0].pageX-event.touches[1].pageX;var b=event.touches[0].pageY-event.touches[1].pageY;return Math.round(Math.sqrt(a*a+b*b))}}function t(){return Math.cos((event.touches[0].pageY-event.touches[1].pageY)/d.pinch.distance)}var b=a(this);this.addEventListener("touchstart",j,false);this.addEventListener("touchmove",k,false);this.addEventListener("touchend",l,false);this.addEventListener("touchcancel",m,false)})}})})(jQuery)